{"version":3,"sources":["../../../../src/modules/tags/methods/get-all.js"],"names":["ERROR_INFO","module","action","plugin","request","client","hgetall","then","result","Object","keys","reduce","tags","tag","assign","Number","catch","err","log","error","Promise","reject"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;;;AAEA,MAAMA,aAAa,EAAEC,+BAAF,EAAuBC,uCAAvB,EAAnB;;AAEA;;;;;;;kBAMgBC,MAAD,IAAaC,OAAD,IAAa;AACtC,SAAOD,OAAOE,MAAP,CAAcC,OAAd,sBACJC,IADI,CACCC,UAAU;AACd,QAAIA,WAAW,IAAf,EAAqB;AACnB,aAAOA,MAAP;AACD;;AAED,WAAOC,OACJC,IADI,CACCF,MADD,EAEJG,MAFI,CAEG,CAACC,IAAD,EAAOC,GAAP,KAAeJ,OACpBK,MADoB,CACbF,IADa,EACP,EAAE,CAAEC,GAAF,GAASE,OAAOP,OAAQK,GAAR,CAAP,CAAX,EADO,CAFlB,EAGgD,EAHhD,CAAP;AAID,GAVI,EAWJG,KAXI,CAWEC,OAAO;AACZb,YAAQc,GAAR,CAAYC,KAAZ,CAAkBF,GAAlB;AACA,WAAOG,QAAQC,MAAR,CAAe,6BAAcjB,OAAd,EAAuBa,GAAvB,EAA4BjB,UAA5B,CAAf,CAAP;AACD,GAdI,CAAP;AAeD,C","file":"get-all.js","sourcesContent":["import { TAGS_KEY } from './../constants';\nimport { MODULE_NAME, ACTION_NAME_GET_ALL } from '../constants';\nimport internalError from '../../../errors/internal-error';\n\nconst ERROR_INFO = { module: MODULE_NAME, action: ACTION_NAME_GET_ALL };\n\n/**\n * Получает ключ TAGS_KEY из кеша с тегами и их текущими значениями\n *\n * @param {object} plugin         Экземпляр плагина\n * @returns {function({tags?: Array<string>}): Promise}\n */\nexport default (plugin) => (request) => {\n  return plugin.client.hgetall(TAGS_KEY)\n    .then(result => {\n      if (result === null) {\n        return result;\n      }\n      \n      return Object\n        .keys(result)\n        .reduce((tags, tag) => Object\n          .assign(tags, { [ tag ]: Number(result[ tag ]) }), {});\n    })\n    .catch(err => {\n      request.log.error(err);\n      return Promise.reject(internalError(request, err, ERROR_INFO));\n    });\n};\n"]}